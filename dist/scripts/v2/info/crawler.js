import { FileSystem } from 'scripts/utils/fsUtils';
import { Color, colorize, colorizeMeetRequirement, } from 'scripts/utils/printUtils.js';
import { getAllServers } from 'scripts/v2/info/allServers';
export async function main(ns) {
    const flags = ns.flags([
        ['s', ''],
        ['d', -1],
        ['custom', ''],
        ['update', false],
        ['help', false],
    ]);
    if (flags.help) {
        const helpMessage = 'USAGE: crawl all servers and return the paths. Default: return all paths.\n' +
            '[OPTIONS]\n' +
            `${colorize('-s <hostname>', Color.CYAN)}: return the path to the target server.\n` +
            `${colorize('-d <{number} depth>', Color.CYAN)}: returns all the server >= depth connected to "home".\n` +
            `${colorize('--custom <key=value>', Color.CYAN)}: return a sever which key = value. Only accept equal.\n` +
            `Choose only 1 option.`;
        return ns.tprint(helpMessage);
    }
    const allServers = getAllServers(ns);
    const { s: targetServer, d: depth, custom } = flags;
    if (targetServer) {
        if (!ns.serverExists(targetServer)) {
            return ns.tprint('ERROR: Invalid target');
        }
        const found = findTarget(allServers, targetServer);
        if (!found) {
            ns.tprint(`ERROR: Target (${targetServer} not found.)`);
            return;
        }
        ns.tprintf('path: %s\n', found.path);
        printInfo(ns, found.info);
        return;
    }
    if (depth >= 0) {
        const satisfiedServers = findRemoteTargets(allServers, depth);
        satisfiedServers.forEach((server) => {
            ns.tprintf('[%2d] %s', server.depth, server.name);
        });
        return;
    }
    if (custom) {
        const [key, value] = custom.split('=');
        if (!key || !value) {
            ns.tprint(`ERROR: invalid key (${key}) or value (${value})`);
        }
        const found = allServers.find((server) => {
            const serverValue = server.info[key];
            return (serverValue === value ||
                (typeof serverValue === 'string' &&
                    serverValue.toLowerCase() === value.toLowerCase()));
        });
        if (!found) {
            return ns.tprint(`ERROR: No results found on ${key} = ${value}`);
        }
        printInfo(ns, found.info);
        ns.tprint(`INFO: path: ${found.path}`);
        return;
    }
    const ALL_SERVERS_PATH = new FileSystem(ns, '/data/all-servers-path.txt');
    const allPaths = allServers.reduce((all, server) => `${all}\n${server.path}`, '');
    await ALL_SERVERS_PATH.write(allPaths, 'w');
    return ns.tprint(allPaths);
}
const findTarget = (servers, target) => {
    const targetName = target.toLowerCase();
    return servers.find((server) => server.name.toLowerCase() === targetName);
};
/**
 * @param {ServerNode[]} servers
 * @param {number} depth
 * @return {ServerNode[]} - List of ServerNode which depth >= given depth from "home", sort by depth desc
 */
const findRemoteTargets = (servers, depth) => {
    return servers
        .filter(({ depth: d }) => d >= depth)
        .sort(({ depth: depthA }, { depth: depthB }) => depthB - depthA);
};
const printInfo = (ns, { hostname, backdoorInstalled, requiredHackingSkill }) => {
    return ns.tprintf(`INFO: %15s | Backdoor?: ${colorizeMeetRequirement('%s', backdoorInstalled ?? false)} | HackingSkill: ${colorizeMeetRequirement('%d', (requiredHackingSkill ?? 0) <= ns.getHackingLevel())}`, hostname, backdoorInstalled, requiredHackingSkill);
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3Jhd2xlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9zY3JpcHRzL3YyL2luZm8vY3Jhd2xlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFDbkQsT0FBTyxFQUNMLEtBQUssRUFDTCxRQUFRLEVBQ1IsdUJBQXVCLEdBQ3hCLE1BQU0sNkJBQTZCLENBQUM7QUFDckMsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBVTNELE1BQU0sQ0FBQyxLQUFLLFVBQVUsSUFBSSxDQUFDLEVBQU07SUFDL0IsTUFBTSxLQUFLLEdBQUcsRUFBRSxDQUFDLEtBQUssQ0FBQztRQUNyQixDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUM7UUFDVCxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUNULENBQUMsUUFBUSxFQUFFLEVBQUUsQ0FBQztRQUNkLENBQUMsUUFBUSxFQUFFLEtBQUssQ0FBQztRQUNqQixDQUFDLE1BQU0sRUFBRSxLQUFLLENBQUM7S0FDaEIsQ0FBVSxDQUFDO0lBRVosSUFBSSxLQUFLLENBQUMsSUFBSSxFQUFFO1FBQ2QsTUFBTSxXQUFXLEdBQ2YsNkVBQTZFO1lBQzdFLGFBQWE7WUFDYixHQUFHLFFBQVEsQ0FDVCxlQUFlLEVBQ2YsS0FBSyxDQUFDLElBQUksQ0FDWCwyQ0FBMkM7WUFDNUMsR0FBRyxRQUFRLENBQ1QscUJBQXFCLEVBQ3JCLEtBQUssQ0FBQyxJQUFJLENBQ1gsMERBQTBEO1lBQzNELEdBQUcsUUFBUSxDQUNULHNCQUFzQixFQUN0QixLQUFLLENBQUMsSUFBSSxDQUNYLDBEQUEwRDtZQUMzRCx1QkFBdUIsQ0FBQztRQUMxQixPQUFPLEVBQUUsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUM7S0FDL0I7SUFFRCxNQUFNLFVBQVUsR0FBRyxhQUFhLENBQUMsRUFBRSxDQUFDLENBQUM7SUFD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QixNQUFNLFVBQVUsR0FBRyxNQUFNLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDeEMsT0FBTyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxLQUFLLFVBQVUsQ0FBQyxDQUFDO0FBQzVFLENBQUMsQ0FBQztBQUVGOzs7O0dBSUc7QUFDSCxNQUFNLGlCQUFpQixHQUFHLENBQUMsT0FBcUIsRUFBRSxLQUFhLEVBQUUsRUFBRTtJQUNqRSxPQUFPLE9BQU87U0FDWCxNQUFNLENBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQyxJQUFJLEtBQUssQ0FBQztTQUNwQyxJQUFJLENBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQyxDQUFDO0FBQ3JFLENBQUMsQ0FBQztBQUVGLE1BQU0sU0FBUyxHQUFHLENBQ2hCLEVBQU0sRUFDTixFQUFFLFFBQVEsRUFBRSxpQkFBaUIsRUFBRSxvQkFBb0IsRUFBVSxFQUM3RCxFQUFFO0lBQ0YsT0FBTyxFQUFFLENBQUMsT0FBTyxDQUNmLDJCQUEyQix1QkFBdUIsQ0FDaEQsSUFBSSxFQUNKLGlCQUFpQixJQUFJLEtBQUssQ0FDM0Isb0JBQW9CLHVCQUF1QixDQUMxQyxJQUFJLEVBQ0osQ0FBQyxvQkFBb0IsSUFBSSxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsZUFBZSxFQUFFLENBQ3BELEVBQUUsRUFDSCxRQUFRLEVBQ1IsaUJBQWlCLEVBQ2pCLG9CQUFvQixDQUNyQixDQUFDO0FBQ0osQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTlMsIFNlcnZlciB9IGZyb20gJ0Bucyc7XG5pbXBvcnQgeyBTZXJ2ZXJOb2RlIH0gZnJvbSAnZGF0YS9TZXJ2ZXJOb2RlJztcbmltcG9ydCB7IEZpbGVTeXN0ZW0gfSBmcm9tICdzY3JpcHRzL3V0aWxzL2ZzVXRpbHMnO1xuaW1wb3J0IHtcbiAgQ29sb3IsXG4gIGNvbG9yaXplLFxuICBjb2xvcml6ZU1lZXRSZXF1aXJlbWVudCxcbn0gZnJvbSAnc2NyaXB0cy91dGlscy9wcmludFV0aWxzLmpzJztcbmltcG9ydCB7IGdldEFsbFNlcnZlcnMgfSBmcm9tICdzY3JpcHRzL3YyL2luZm8vYWxsU2VydmVycyc7XG5cbnR5cGUgRmxhZ3MgPSB7XG4gIHM6IHN0cmluZztcbiAgZDogbnVtYmVyO1xuICBjdXN0b206IHN0cmluZztcbiAgdXBkYXRlOiBib29sZWFuO1xuICBoZWxwOiBib29sZWFuO1xufTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG1haW4obnM6IE5TKSB7XG4gIGNvbnN0IGZsYWdzID0gbnMuZmxhZ3MoW1xuICAgIFsncycsICcnXSxcbiAgICBbJ2QnLCAtMV0sXG4gICAgWydjdXN0b20nLCAnJ10sXG4gICAgWyd1cGRhdGUnLCBmYWxzZV0sXG4gICAgWydoZWxwJywgZmFsc2VdLFxuICBdKSBhcyBGbGFncztcblxuICBpZiAoZmxhZ3MuaGVscCkge1xuICAgIGNvbnN0IGhlbHBNZXNzYWdlID1cbiAgICAgICdVU0FHRTogY3Jhd2wgYWxsIHNlcnZlcnMgYW5kIHJldHVybiB0aGUgcGF0aHMuIERlZmF1bHQ6IHJldHVybiBhbGwgcGF0aHMuXFxuJyArXG4gICAgICAnW09QVElPTlNdXFxuJyArXG4gICAgICBgJHtjb2xvcml6ZShcbiAgICAgICAgJy1zIDxob3N0bmFtZT4nLFxuICAgICAgICBDb2xvci5DWUFOXG4gICAgICApfTogcmV0dXJuIHRoZSBwYXRoIHRvIHRoZSB0YXJnZXQgc2VydmVyLlxcbmAgK1xuICAgICAgYCR7Y29sb3JpemUoXG4gICAgICAgICctZCA8e251bWJlcn0gZGVwdGg+JyxcbiAgICAgICAgQ29sb3IuQ1lBTlxuICAgICAgKX06IHJldHVybnMgYWxsIHRoZSBzZXJ2ZXIgPj0gZGVwdGggY29ubmVjdGVkIHRvIFwiaG9tZVwiLlxcbmAgK1xuICAgICAgYCR7Y29sb3JpemUoXG4gICAgICAgICctLWN1c3RvbSA8a2V5PXZhbHVlPicsXG4gICAgICAgIENvbG9yLkNZQU5cbiAgICAgICl9OiByZXR1cm4gYSBzZXZlciB3aGljaCBrZXkgPSB2YWx1ZS4gT25seSBhY2NlcHQgZXF1YWwuXFxuYCArXG4gICAgICBgQ2hvb3NlIG9ubHkgMSBvcHRpb24uYDtcbiAgICByZXR1cm4gbnMudHByaW50KGhlbHBNZXNzYWdlKTtcbiAgfVxuXG4gIGNvbnN0IGFsbFNlcnZlcnMgPSBnZXRBbGxTZXJ2ZXJzKG5zKTtcbiAgY29uc3QgeyBzOiB0YXJnZXRTZXJ2ZXIsIGQ6IGRlcHRoLCBjdXN0b20gfSA9IGZsYWdzO1xuXG4gIGlmICh0YXJnZXRTZXJ2ZXIpIHtcbiAgICBpZiAoIW5zLnNlcnZlckV4aXN0cyh0YXJnZXRTZXJ2ZXIpKSB7XG4gICAgICByZXR1cm4gbnMudHByaW50KCdFUlJPUjogSW52YWxpZCB0YXJnZXQnKTtcbiAgICB9XG4gICAgY29uc3QgZm91bmQgPSBmaW5kVGFyZ2V0KGFsbFNlcnZlcnMsIHRhcmdldFNlcnZlcik7XG4gICAgaWYgKCFmb3VuZCkge1xuICAgICAgbnMudHByaW50KGBFUlJPUjogVGFyZ2V0ICgke3RhcmdldFNlcnZlcn0gbm90IGZvdW5kLilgKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbnMudHByaW50ZigncGF0aDogJXNcXG4nLCBmb3VuZC5wYXRoKTtcbiAgICBwcmludEluZm8obnMsIGZvdW5kLmluZm8pO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChkZXB0aCA+PSAwKSB7XG4gICAgY29uc3Qgc2F0aXNmaWVkU2VydmVycyA9IGZpbmRSZW1vdGVUYXJnZXRzKGFsbFNlcnZlcnMsIGRlcHRoKTtcbiAgICBzYXRpc2ZpZWRTZXJ2ZXJzLmZvckVhY2goKHNlcnZlcikgPT4ge1xuICAgICAgbnMudHByaW50ZignWyUyZF0gJXMnLCBzZXJ2ZXIuZGVwdGgsIHNlcnZlci5uYW1lKTtcbiAgICB9KTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoY3VzdG9tKSB7XG4gICAgY29uc3QgW2tleSwgdmFsdWVdID0gY3VzdG9tLnNwbGl0KCc9Jyk7XG5cbiAgICBpZiAoIWtleSB8fCAhdmFsdWUpIHtcbiAgICAgIG5zLnRwcmludChgRVJST1I6IGludmFsaWQga2V5ICgke2tleX0pIG9yIHZhbHVlICgke3ZhbHVlfSlgKTtcbiAgICB9XG5cbiAgICBjb25zdCBmb3VuZCA9IGFsbFNlcnZlcnMuZmluZCgoc2VydmVyKSA9PiB7XG4gICAgICBjb25zdCBzZXJ2ZXJWYWx1ZSA9IHNlcnZlci5pbmZvW2tleSBhcyBrZXlvZiBTZXJ2ZXJdO1xuICAgICAgcmV0dXJuIChcbiAgICAgICAgc2VydmVyVmFsdWUgPT09IHZhbHVlIHx8XG4gICAgICAgICh0eXBlb2Ygc2VydmVyVmFsdWUgPT09ICdzdHJpbmcnICYmXG4gICAgICAgICAgc2VydmVyVmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gdmFsdWUudG9Mb3dlckNhc2UoKSlcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpZiAoIWZvdW5kKSB7XG4gICAgICByZXR1cm4gbnMudHByaW50KGBFUlJPUjogTm8gcmVzdWx0cyBmb3VuZCBvbiAke2tleX0gPSAke3ZhbHVlfWApO1xuICAgIH1cbiAgICBwcmludEluZm8obnMsIGZvdW5kLmluZm8pO1xuICAgIG5zLnRwcmludChgSU5GTzogcGF0aDogJHtmb3VuZC5wYXRofWApO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IEFMTF9TRVJWRVJTX1BBVEggPSBuZXcgRmlsZVN5c3RlbShucywgJy9kYXRhL2FsbC1zZXJ2ZXJzLXBhdGgudHh0Jyk7XG4gIGNvbnN0IGFsbFBhdGhzID0gYWxsU2VydmVycy5yZWR1Y2UoXG4gICAgKGFsbCwgc2VydmVyKSA9PiBgJHthbGx9XFxuJHtzZXJ2ZXIucGF0aH1gLFxuICAgICcnXG4gICk7XG4gIGF3YWl0IEFMTF9TRVJWRVJTX1BBVEgud3JpdGUoYWxsUGF0aHMsICd3Jyk7XG4gIHJldHVybiBucy50cHJpbnQoYWxsUGF0aHMpO1xufVxuXG5jb25zdCBmaW5kVGFyZ2V0ID0gKFxuICBzZXJ2ZXJzOiBTZXJ2ZXJOb2RlW10sXG4gIHRhcmdldDogc3RyaW5nXG4pOiBTZXJ2ZXJOb2RlIHwgdW5kZWZpbmVkID0+IHtcbiAgY29uc3QgdGFyZ2V0TmFtZSA9IHRhcmdldC50b0xvd2VyQ2FzZSgpO1xuICByZXR1cm4gc2VydmVycy5maW5kKChzZXJ2ZXIpID0+IHNlcnZlci5uYW1lLnRvTG93ZXJDYXNlKCkgPT09IHRhcmdldE5hbWUpO1xufTtcblxuLyoqXG4gKiBAcGFyYW0ge1NlcnZlck5vZGVbXX0gc2VydmVyc1xuICogQHBhcmFtIHtudW1iZXJ9IGRlcHRoXG4gKiBAcmV0dXJuIHtTZXJ2ZXJOb2RlW119IC0gTGlzdCBvZiBTZXJ2ZXJOb2RlIHdoaWNoIGRlcHRoID49IGdpdmVuIGRlcHRoIGZyb20gXCJob21lXCIsIHNvcnQgYnkgZGVwdGggZGVzY1xuICovXG5jb25zdCBmaW5kUmVtb3RlVGFyZ2V0cyA9IChzZXJ2ZXJzOiBTZXJ2ZXJOb2RlW10sIGRlcHRoOiBudW1iZXIpID0+IHtcbiAgcmV0dXJuIHNlcnZlcnNcbiAgICAuZmlsdGVyKCh7IGRlcHRoOiBkIH0pID0+IGQgPj0gZGVwdGgpXG4gICAgLnNvcnQoKHsgZGVwdGg6IGRlcHRoQSB9LCB7IGRlcHRoOiBkZXB0aEIgfSkgPT4gZGVwdGhCIC0gZGVwdGhBKTtcbn07XG5cbmNvbnN0IHByaW50SW5mbyA9IChcbiAgbnM6IE5TLFxuICB7IGhvc3RuYW1lLCBiYWNrZG9vckluc3RhbGxlZCwgcmVxdWlyZWRIYWNraW5nU2tpbGwgfTogU2VydmVyXG4pID0+IHtcbiAgcmV0dXJuIG5zLnRwcmludGYoXG4gICAgYElORk86ICUxNXMgfCBCYWNrZG9vcj86ICR7Y29sb3JpemVNZWV0UmVxdWlyZW1lbnQoXG4gICAgICAnJXMnLFxuICAgICAgYmFja2Rvb3JJbnN0YWxsZWQgPz8gZmFsc2VcbiAgICApfSB8IEhhY2tpbmdTa2lsbDogJHtjb2xvcml6ZU1lZXRSZXF1aXJlbWVudChcbiAgICAgICclZCcsXG4gICAgICAocmVxdWlyZWRIYWNraW5nU2tpbGwgPz8gMCkgPD0gbnMuZ2V0SGFja2luZ0xldmVsKClcbiAgICApfWAsXG4gICAgaG9zdG5hbWUsXG4gICAgYmFja2Rvb3JJbnN0YWxsZWQsXG4gICAgcmVxdWlyZWRIYWNraW5nU2tpbGxcbiAgKTtcbn07XG4iXX0=